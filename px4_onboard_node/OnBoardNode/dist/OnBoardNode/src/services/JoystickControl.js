'use strict';const a20_0x10819e=a20_0x58a9;(function(_0x3a8e65,_0x44ed5e){const _0x433295=a20_0x58a9,_0x40029b=_0x3a8e65();while(!![]){try{const _0x5081d2=parseInt(_0x433295(0x12f))/0x1+parseInt(_0x433295(0x113))/0x2+-parseInt(_0x433295(0x130))/0x3+parseInt(_0x433295(0xd7))/0x4*(-parseInt(_0x433295(0x106))/0x5)+-parseInt(_0x433295(0xed))/0x6*(-parseInt(_0x433295(0x11d))/0x7)+-parseInt(_0x433295(0x133))/0x8+parseInt(_0x433295(0x11f))/0x9*(-parseInt(_0x433295(0x124))/0xa);if(_0x5081d2===_0x44ed5e)break;else _0x40029b['push'](_0x40029b['shift']());}catch(_0x5a0f9e){_0x40029b['push'](_0x40029b['shift']());}}}(a20_0x2a6e,0x4a428));Object[a20_0x10819e(0xf0)](exports,a20_0x10819e(0x117),{'value':!![]}),exports[a20_0x10819e(0xda)]=void 0x0;const ob_node_types_1=require(a20_0x10819e(0x119)),dgram_1=require('dgram'),serverUDP_1=require(a20_0x10819e(0x100)),clientUDP_1=require(a20_0x10819e(0xfc)),all_typings_1=require(a20_0x10819e(0xeb)),ds_typings_1=require(a20_0x10819e(0x134)),CheckingActivity_1=require(a20_0x10819e(0x12a)),ConsolePrints_1=require('../ConsolePrints'),MoveXYManager_1=require(a20_0x10819e(0xef)),airVechicleManager_1=require('./airVehicle/airVechicleManager'),server=(0x0,dgram_1[a20_0x10819e(0x101)])(a20_0x10819e(0x128));class JoystickControl{constructor(){const _0xae3613=a20_0x10819e;this[_0xae3613(0xd3)]={},this[_0xae3613(0xec)]={'date':0x0,'velocityAndYawRateCtrl':!![],'vx':0x0,'vy':0x0,'vz':0x0,'yaw':0x0,'type':ob_node_types_1['typesUDP']['none']},this['forceType']=_0xae3613(0xd5),this[_0xae3613(0xfb)]=!![],this[_0xae3613(0xf2)]=_0x56ec8a=>{const _0x1031c1=_0xae3613;this['sending'](),this['projConf']=_0x56ec8a,server['on'](_0x1031c1(0xde),_0x88cf6=>{const _0x2989f2=_0x1031c1;console[_0x2989f2(0x10c)](_0x2989f2(0x11c)+_0x88cf6['stack']);}),server['on']('message',(_0x308b31,_0xee9ebd)=>{const _0x332028=_0x1031c1;let _0x1ffef3;try{_0x1ffef3=JSON[_0x332028(0xcf)](_0x308b31[_0x332028(0x10b)]());const _0x980df6=_0x1ffef3[_0x332028(0xd2)],_0x4cdefc=_0x1ffef3[_0x332028(0xe5)],_0x20fa9a=serverUDP_1[_0x332028(0x105)][_0x332028(0x112)]();if(_0x4cdefc===all_typings_1['SEND_UDP_ACTIONS'][_0x332028(0xf3)]){const _0x4ccb07={'gimbal':!![],'pitch':_0x1ffef3[_0x332028(0xea)],'roll':_0x1ffef3[_0x332028(0x12c)],'yaw':_0x1ffef3[_0x332028(0x10d)]-_0x20fa9a[_0x332028(0x110)],'time':0.5,'rotationMode':0x0};serverUDP_1[_0x332028(0x105)][_0x332028(0xdc)](_0x4ccb07[_0x332028(0x10d)],_0x4ccb07[_0x332028(0x12c)],_0x4ccb07[_0x332028(0xea)]),console['log'](_0x332028(0x123),_0x4ccb07[_0x332028(0xea)],_0x4ccb07[_0x332028(0x10d)]);}switch(_0x980df6){case ob_node_types_1[_0x332028(0x109)]['joystick']:{_0x20fa9a[_0x332028(0x12d)][_0x332028(0x111)]===all_typings_1[_0x332028(0x131)]['InProcess']&&MoveXYManager_1['MoveXYManager'][_0x332028(0xfd)]()[_0x332028(0x126)](_0x5d461b=>{})[_0x332028(0xe1)](_0x285a37=>{});_0x20fa9a['owner']===ds_typings_1['OWNER']['joystick']&&!airVechicleManager_1[_0x332028(0xd8)][_0x332028(0xe9)]()&&this[_0x332028(0xe7)](_0x1ffef3);break;}case ob_node_types_1[_0x332028(0x109)][_0x332028(0xd9)]:{_0x20fa9a['owner']===ds_typings_1['OWNER']['droneService']&&!airVechicleManager_1['AirVehicleManager']['getLastTimeStartedLandNow']()&&_0x20fa9a[_0x332028(0xe8)]['armed']&&(_0x4cdefc===all_typings_1['SEND_UDP_ACTIONS'][_0x332028(0xd6)]&&(_0x1ffef3['vz']*-0x1,this['updateParams'](_0x1ffef3)));break;}case ob_node_types_1[_0x332028(0x109)][_0x332028(0xe6)]:{!airVechicleManager_1[_0x332028(0xd8)]['getLastTimeStartedLandNow']()&&(_0x4cdefc===all_typings_1[_0x332028(0x102)][_0x332028(0xd6)]&&this[_0x332028(0xe7)](_0x1ffef3));break;}case ob_node_types_1[_0x332028(0x109)]['CAS']:{!airVechicleManager_1[_0x332028(0xd8)]['getLastTimeStartedLandNow']()&&(_0x4cdefc===all_typings_1[_0x332028(0x102)][_0x332028(0xd6)]&&this[_0x332028(0xe7)](_0x1ffef3));break;}}}catch(_0x5dbd15){}}),server['on']('listening',()=>{const _0x2a373f=_0x1031c1,_0x279246=server[_0x2a373f(0x107)]();console['log']();}),server[_0x1031c1(0xdf)](_0x56ec8a[_0x1031c1(0x132)][_0x1031c1(0xcb)]),console[_0x1031c1(0x10c)](_0x1031c1(0xd1),_0x56ec8a['onBoardNodeJsService']['serverUDP4FCS'],_0x1031c1(0xe4));},this[_0xae3613(0xd0)]=_0x6ac77b=>{const _0x60222c=_0xae3613;ConsolePrints_1[_0x60222c(0xf4)][_0x60222c(0x115)](JSON['stringify'](_0x6ac77b),JoystickControl['name'],'updateForceType'),this[_0x60222c(0xfe)]=_0x6ac77b;},this[_0xae3613(0xe7)]=_0x35089d=>{const _0x36ec83=_0xae3613;ConsolePrints_1['ConsolePrints'][_0x36ec83(0x115)](JSON[_0x36ec83(0x104)](_0x35089d),JoystickControl[_0x36ec83(0xf8)],'updateParams\x20as\x20is'),this['myObj']={'date':_0x35089d[_0x36ec83(0xe2)],'velocityAndYawRateCtrl':!![],'vx':_0x35089d['vx'],'vy':_0x35089d['vy'],'vz':_0x35089d['vz'],'yaw':_0x35089d[_0x36ec83(0x10d)],'type':_0x35089d[_0x36ec83(0xd2)]};let _0x15dcbf=0x0;},this[_0xae3613(0x120)]=()=>{let _0x1cee07=-0x1;setInterval(()=>{const _0x43bd3a=a20_0x58a9,_0x774590=Date[_0x43bd3a(0x12b)](),_0x1c1218=serverUDP_1[_0x43bd3a(0x105)][_0x43bd3a(0x112)](),_0x4311e8=_0x1c1218[_0x43bd3a(0xe8)][_0x43bd3a(0xcd)],_0x199b46=serverUDP_1[_0x43bd3a(0x105)][_0x43bd3a(0xf7)](),_0x10515f=Math[_0x43bd3a(0xd4)](_0x199b46['position'][_0x43bd3a(0x122)])>0x1,_0x13299f=_0x4311e8;(Math['abs'](this[_0x43bd3a(0xec)]['vx'])>0x0||Math[_0x43bd3a(0xd4)](this[_0x43bd3a(0xec)]['vy'])>0x0||Math[_0x43bd3a(0xd4)](this['myObj']['vz'])>0x0||Math['abs'](this[_0x43bd3a(0xec)][_0x43bd3a(0x10d)])>0x0)&&_0x13299f&&(_0x1cee07===-0x1||this[_0x43bd3a(0xec)][_0x43bd3a(0xe2)]!==_0x1cee07)?(ConsolePrints_1['ConsolePrints'][_0x43bd3a(0x115)](JSON[_0x43bd3a(0x104)]({'myobj':this[_0x43bd3a(0xec)],'state':_0x13299f,'lastDate':_0x1cee07}),JoystickControl['name'],_0x43bd3a(0x108)+_0x43bd3a(0xca)+_0x43bd3a(0xc9)+_0x43bd3a(0xf9)+_0x43bd3a(0x127)+_0x43bd3a(0x116)),this[_0x43bd3a(0xfb)]=![],this[_0x43bd3a(0xce)](),_0x1cee07=this['myObj']['date']):!this[_0x43bd3a(0xfb)]&&(this[_0x43bd3a(0xfb)]=!![],this[_0x43bd3a(0xec)]['vx']=this[_0x43bd3a(0xec)]['vy']=this[_0x43bd3a(0xec)]['vz']=0x0,this[_0x43bd3a(0xce)](),ConsolePrints_1[_0x43bd3a(0xf4)]['out'](JSON['stringify'](this[_0x43bd3a(0xec)]),JoystickControl['name'],_0x43bd3a(0x118)));},0x64);},this['sendForce']=()=>{const _0x3ee460=_0xae3613,_0x19f8aa=serverUDP_1[_0x3ee460(0x105)][_0x3ee460(0x112)]()[_0x3ee460(0x11e)];let _0x36d563;this[_0x3ee460(0xfe)]===_0x3ee460(0xdd)||this[_0x3ee460(0xfe)]==='auto'&&_0x19f8aa>=0x4?_0x36d563={'date':this['myObj'][_0x3ee460(0xe2)],'velocityAndYawRateCtrl':!![],'vx':this[_0x3ee460(0xec)]['vx'],'vy':this['myObj']['vy'],'vz':-this[_0x3ee460(0xec)]['vz'],'yaw':-this['myObj'][_0x3ee460(0x10d)],'isGps':!![]}:(_0x36d563={'date':this[_0x3ee460(0xec)]['date'],'velocityAndYawRateCtrl':!![],'vx':Math[_0x3ee460(0xf1)](this['myObj']['vy']/this['projConf'][_0x3ee460(0x132)][_0x3ee460(0xe0)],0x1)*this[_0x3ee460(0xd3)][_0x3ee460(0x132)]['joystickMaxAngle'],'vy':Math[_0x3ee460(0xf1)](-this[_0x3ee460(0xec)]['vx']/this[_0x3ee460(0xd3)][_0x3ee460(0x132)][_0x3ee460(0xe0)],0x1)*this['projConf']['onBoardNodeJsService'][_0x3ee460(0xf6)],'vz':0.5+Math[_0x3ee460(0xf1)](this[_0x3ee460(0xec)]['vz']/this[_0x3ee460(0xd3)][_0x3ee460(0x132)]['joystickMaxThrottle'],0x1)*0.5,'yaw':-this['myObj'][_0x3ee460(0x10d)],'isGps':![]},ConsolePrints_1[_0x3ee460(0xf4)][_0x3ee460(0x115)](JSON[_0x3ee460(0x104)](_0x36d563),JoystickControl['name'],_0x3ee460(0x129)));const _0x4ff745=JSON['stringify'](_0x36d563),_0x739e9a=serverUDP_1[_0x3ee460(0x105)][_0x3ee460(0x112)]();CheckingActivity_1[_0x3ee460(0xcc)][_0x3ee460(0x103)]()&&(this[_0x3ee460(0xec)][_0x3ee460(0xd2)]===ob_node_types_1[_0x3ee460(0x109)][_0x3ee460(0xdb)]||this['myObj']['type']===ob_node_types_1['typesUDP'][_0x3ee460(0xe6)]||this[_0x3ee460(0xec)][_0x3ee460(0xd2)]===ob_node_types_1[_0x3ee460(0x109)][_0x3ee460(0xd9)]||_0x739e9a[_0x3ee460(0x10e)]===ds_typings_1[_0x3ee460(0x10a)]['joystick'])?(ConsolePrints_1[_0x3ee460(0xf4)]['out'](JSON['stringify'](_0x4ff745),JoystickControl[_0x3ee460(0xf8)],_0x3ee460(0xfa)),clientUDP_1[_0x3ee460(0x11b)][_0x3ee460(0xee)](_0x4ff745,this[_0x3ee460(0xd3)][_0x3ee460(0x132)]['requestServicePy'][_0x3ee460(0xf5)],this[_0x3ee460(0xd3)]['onBoardNodeJsService'][_0x3ee460(0x125)][_0x3ee460(0xff)],_0x538ffa=>{const _0x22fafe=_0x3ee460;!_0x538ffa['success']?(ConsolePrints_1[_0x22fafe(0xf4)]['out'](_0x22fafe(0x11a),JoystickControl[_0x22fafe(0xf8)],'sendForce'),_0x538ffa[_0x22fafe(0x114)][_0x22fafe(0xe3)](_0x22fafe(0x121))):ConsolePrints_1[_0x22fafe(0xf4)][_0x22fafe(0x115)]('sentJoystick\x20with\x20SUCCESS',JoystickControl[_0x22fafe(0xf8)],'sendForce');})):(console[_0x3ee460(0x10c)](new Date(),'cannot\x20send\x20Joystick\x20commands\x20OWNER\x20',_0x739e9a[_0x3ee460(0x10e)]),ConsolePrints_1[_0x3ee460(0xf4)]['out']('cannot\x20send\x20Joystick\x20commands\x20OWNER\x20'+_0x739e9a[_0x3ee460(0x10e)],JoystickControl['name'],_0x3ee460(0xce)));};}}exports[a20_0x10819e(0xda)]=JoystickControl,JoystickControl['instance']=new JoystickControl(),JoystickControl[a20_0x10819e(0xf2)]=JoystickControl[a20_0x10819e(0x10f)][a20_0x10819e(0xf2)],JoystickControl[a20_0x10819e(0x12e)]=JoystickControl['instance'][a20_0x10819e(0xe7)],JoystickControl['updateParams']=JoystickControl['instance'][a20_0x10819e(0xe7)],JoystickControl[a20_0x10819e(0xd0)]=JoystickControl[a20_0x10819e(0x10f)][a20_0x10819e(0xd0)];function a20_0x58a9(_0xf00fa5,_0x11ce8){const _0x2a6ef7=a20_0x2a6e();return a20_0x58a9=function(_0x58a91d,_0x104d9e){_0x58a91d=_0x58a91d-0xc9;let _0x5235b2=_0x2a6ef7[_0x58a91d];return _0x5235b2;},a20_0x58a9(_0xf00fa5,_0x11ce8);}function a20_0x2a6e(){const _0x1cb50b=['683926hHuKzT','message','out','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20&&\x20(lastDate\x20===\x20-1\x20||\x20this.myObj.date\x20!==\x20lastDate)','__esModule','sendForce\x20!this.isSend0','../../../classes/typings/ob-node-types','sentJoystick\x20with\x20error','ClientUDP','server\x20error:\x0a','1708259LYyzai','gps_health','261wJoWhD','sending','Error','relative_altitude_m','gimbal','80830QgQetf','requestServicePy','then','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20&&\x20state\x0a','udp4','sendForce\x20!(forceType\x20===\x20\x22GPS\x22\x20||\x20(this.forceType\x20===\x20\x22auto\x22\x20&&\x20gpsStatus\x20>=\x204)','./CheckingActivity','now','roll','flightCommandServiceStatus','start','79285CnfJct','231972ZhkvBl','FLIGHT_SERVICE_STATUS','onBoardNodeJsService','1372016GjwFSf','../../../classes/typings/ds.typings','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20||\x20Math.abs(this.myObj.vz)\x20>\x200\x0a','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20||\x20Math.abs(this.myObj.vy)\x20>\x200\x0a','serverUDP4FCS','CheckingActivity','armed','sendForce','parse','updateForceType','udp\x20server\x20','type','projConf','abs','auto','FORCE','4SJLwuh','AirVehicleManager','IRLockLanding','JoystickControl','CAS','setTelemetryGimbal','GPS','error','bind','joystickMaxVelocity','catch','date','push','started','action','movexy','updateParams','state','getLastTimeStartedLandNow','pitch','../../../classes/typings/all.typings','myObj','12jOwEhm','sendJoystick','./moveXY/MoveXYManager','defineProperty','min','listen','GIMBAL','ConsolePrints','portUDP','joystickMaxAngle','getCurTelemetryOriginal','name','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20||\x20Math.abs(this.myObj.yaw)\x20>\x200)\x0a','sendForce\x20(CheckingActivity.isAllowRCMode()\x20&&\x20telemetry.owner\x20===\x20OWNER.joystick)','isSend0','./TCPUDP/clientUDP','stopMoveXY','forceType','host','./TCPUDP/serverUDP','createSocket','SEND_UDP_ACTIONS','isAllowRCMode','stringify','UdpServer','609605yYHMSL','address','sendForce\x20(Math.abs(this.myObj.vx)\x20>\x200\x0a','typesUDP','OWNER','toString','log','yaw','owner','instance','heading','status','getTelemetryData'];a20_0x2a6e=function(){return _0x1cb50b;};return a20_0x2a6e();}